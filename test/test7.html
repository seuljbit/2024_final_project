<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        .star {
          cursor: pointer;
          margin-right: 10px;
          transition: fill 0.3s ease;
        }

.rating-container {
  margin-top: 10px;
  font-size: 18px;
  text-align: center;
}
    </style>
</head>
<body>
    <div class="rate_stars">
    <svg class="star" data-value="1" width="58" height="55" viewBox="0 0 58 55" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <linearGradient id="starGradient1" x1="0%" y1="0%" x2="100%" y2="0%">
            <stop offset="0%" stop-color="#E7B343" />
            <stop offset="100%" stop-color="#E4E4E4" />
          </linearGradient>
        </defs>
        <path d="M33.9544 3.72284C32.0027 -0.916729 25.3544 -0.916729 23.4027 3.72284L18.3979 15.6128L5.40933 16.6429C0.344613 17.0424 -1.70981 23.2941 2.15079 26.564L12.0463 34.9444L9.0217 47.4763C7.84326 52.3642 13.2218 56.2276 17.559 53.6082L28.6785 46.8943L39.7981 53.6111C44.1352 56.2305 49.5138 52.367 48.3354 47.4763L45.3108 34.9501L55.2063 26.5669C59.0669 23.2969 57.0124 17.0481 51.9477 16.6457L38.9592 15.6185L33.9544 3.72284Z" fill="url(#starGradient1)" />
      </svg>
    <svg class="star" data-value="2" width="58" height="55" viewBox="0 0 58 55" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <linearGradient id="starGradient2" x1="0%" y1="0%" x2="100%" y2="0%">
            <stop offset="0%" stop-color="#E7B343" />
            <stop offset="100%" stop-color="#E4E4E4" />
          </linearGradient>
        </defs>
        <path d="M33.9544 3.72284C32.0027 -0.916729 25.3544 -0.916729 23.4027 3.72284L18.3979 15.6128L5.40933 16.6429C0.344613 17.0424 -1.70981 23.2941 2.15079 26.564L12.0463 34.9444L9.0217 47.4763C7.84326 52.3642 13.2218 56.2276 17.559 53.6082L28.6785 46.8943L39.7981 53.6111C44.1352 56.2305 49.5138 52.367 48.3354 47.4763L45.3108 34.9501L55.2063 26.5669C59.0669 23.2969 57.0124 17.0481 51.9477 16.6457L38.9592 15.6185L33.9544 3.72284Z" fill="url(#starGradient2)" />
      </svg>
    <svg class="star" data-value="3" width="58" height="55" viewBox="0 0 58 55" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <linearGradient id="starGradient3" x1="0%" y1="0%" x2="100%" y2="0%">
            <stop offset="0%" stop-color="#E7B343" />
            <stop offset="100%" stop-color="#E4E4E4" />
          </linearGradient>
        </defs>
        <path d="M33.9544 3.72284C32.0027 -0.916729 25.3544 -0.916729 23.4027 3.72284L18.3979 15.6128L5.40933 16.6429C0.344613 17.0424 -1.70981 23.2941 2.15079 26.564L12.0463 34.9444L9.0217 47.4763C7.84326 52.3642 13.2218 56.2276 17.559 53.6082L28.6785 46.8943L39.7981 53.6111C44.1352 56.2305 49.5138 52.367 48.3354 47.4763L45.3108 34.9501L55.2063 26.5669C59.0669 23.2969 57.0124 17.0481 51.9477 16.6457L38.9592 15.6185L33.9544 3.72284Z" fill="url(#starGradient3)" />
      </svg>
    <svg class="star" data-value="4" width="58" height="55" viewBox="0 0 58 55" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <linearGradient id="starGradient4" x1="0%" y1="0%" x2="100%" y2="0%">
            <stop offset="0%" stop-color="#E7B343" />
            <stop offset="100%" stop-color="#E4E4E4" />
          </linearGradient>
        </defs>
        <path d="M33.9544 3.72284C32.0027 -0.916729 25.3544 -0.916729 23.4027 3.72284L18.3979 15.6128L5.40933 16.6429C0.344613 17.0424 -1.70981 23.2941 2.15079 26.564L12.0463 34.9444L9.0217 47.4763C7.84326 52.3642 13.2218 56.2276 17.559 53.6082L28.6785 46.8943L39.7981 53.6111C44.1352 56.2305 49.5138 52.367 48.3354 47.4763L45.3108 34.9501L55.2063 26.5669C59.0669 23.2969 57.0124 17.0481 51.9477 16.6457L38.9592 15.6185L33.9544 3.72284Z" fill="url(#starGradient4)" />
      </svg>
    <svg class="star" data-value="5" width="58" height="55" viewBox="0 0 58 55" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <linearGradient id="starGradient5" x1="0%" y1="0%" x2="100%" y2="0%">
            <stop offset="0%" stop-color="#E7B343" />
            <stop offset="100%" stop-color="#E4E4E4" />
          </linearGradient>
        </defs>
        <path d="M33.9544 3.72284C32.0027 -0.916729 25.3544 -0.916729 23.4027 3.72284L18.3979 15.6128L5.40933 16.6429C0.344613 17.0424 -1.70981 23.2941 2.15079 26.564L12.0463 34.9444L9.0217 47.4763C7.84326 52.3642 13.2218 56.2276 17.559 53.6082L28.6785 46.8943L39.7981 53.6111C44.1352 56.2305 49.5138 52.367 48.3354 47.4763L45.3108 34.9501L55.2063 26.5669C59.0669 23.2969 57.0124 17.0481 51.9477 16.6457L38.9592 15.6185L33.9544 3.72284Z" fill="url(#starGradient5)" />
      </svg>
    </div>
      <div class="rating-container">
        <p class="rating-value">0.0</p>
      </div>
      
      <script>
        document.addEventListener('DOMContentLoaded', () => {
          const stars = document.querySelectorAll('.star');
          const ratingValue = document.querySelector('.rating-value');
          const rateStars = document.querySelector('.rate_stars'); // 별점 영역
          let currentHoverIndex = -1; // 현재 호버 중인 별의 인덱스
          let isHalfHover = false; // 현재 반쪽 여부
          let selectedRating = 0; // 선택된 별점 값
        
          stars.forEach((star, index) => {
            // 별점 호버 이벤트
            star.addEventListener('mousemove', (e) => {
              const rect = star.getBoundingClientRect();
              const offsetX = e.clientX - rect.left;
              const isHalf = offsetX < rect.width / 2; // 반쪽 여부 확인
        
              // 중복 호출 방지
              if (currentHoverIndex === index && isHalfHover === isHalf) return;
        
              currentHoverIndex = index; // 현재 호버 중인 별 업데이트
              isHalfHover = isHalf; // 현재 반쪽 여부 업데이트
        
              // 모든 별 초기화
              stars.forEach((s, i) => {
                const gradientId = `starGradient${i + 1}`; // 각 별의 고유 ID
                const gradient = document.querySelector(`#${gradientId} stop:nth-child(2)`); // 회색 부분
                const firstStop = document.querySelector(`#${gradientId} stop:nth-child(1)`); // 노란 부분
        
                if (i < index) {
                  firstStop.setAttribute('offset', '100%'); // 이전 별은 전체 노란색
                  gradient.setAttribute('offset', '100%');
                } else if (i === index && isHalf) {
                  firstStop.setAttribute('offset', '50%'); // 현재 별은 반쪽 노란색
                  gradient.setAttribute('offset', '50%');
                } else if (i === index && !isHalf) {
                  firstStop.setAttribute('offset', '100%'); // 현재 별은 전체 노란색
                  gradient.setAttribute('offset', '100%');
                } else {
                  firstStop.setAttribute('offset', '0%'); // 나머지는 회색
                  gradient.setAttribute('offset', '0%');
                }
              });
        
              // 현재 별점 표시
              const hoverRating = isHalf ? index + 0.5 : index + 1;
              ratingValue.textContent = `${hoverRating}점`;
            });
        
            // 별점 클릭 이벤트
            star.addEventListener('click', (e) => {
              const rect = star.getBoundingClientRect();
              const offsetX = e.clientX - rect.left;
              const isHalf = offsetX < rect.width / 2;
              const clickedRating = isHalf ? index + 0.5 : index + 1;

              // 같은 점수를 클릭하면 0점으로 초기화
              if (selectedRating === clickedRating) {
                selectedRating = 0;
                updateStars(-1, false);
                ratingValue.textContent = '0점';
              } else {
                // 선택된 별점 값 저장
                selectedRating = clickedRating;
                ratingValue.textContent = `${selectedRating}점`;

                // 별점 확정
                updateStars(index, isHalf);
              }
            });
        
            // 별점에서 마우스를 뺐을 때 초기화
            star.addEventListener('mouseleave', () => {
              if (selectedRating === 0) {
                // 별점 선택이 없을 때만 초기화
                stars.forEach((s, i) => {
                  const gradientId = `starGradient${i + 1}`;
                  const gradient = document.querySelector(`#${gradientId} stop:nth-child(2)`);
                  const firstStop = document.querySelector(`#${gradientId} stop:nth-child(1)`);
        
                  // 모든 별을 회색으로
                  firstStop.setAttribute('offset', '0%');
                  gradient.setAttribute('offset', '0%');
                });
        
                ratingValue.textContent = '0점'; // 점수 초기화
              }
        
              currentHoverIndex = -1; // 호버 상태 초기화
              isHalfHover = false; // 반쪽 여부 초기화
            });
          });
        
          // `rate_stars` 영역 밖으로 나갔을 때 초기화
          document.addEventListener('mousemove', (e) => {
            const rect = rateStars.getBoundingClientRect(); // 별점 영역
            const isOutside =
              e.clientX < rect.left ||
              e.clientX > rect.right ||
              e.clientY < rect.top ||
              e.clientY > rect.bottom;
        
            if (isOutside && selectedRating === 0 && !rateStars.contains(e.target)) {
              stars.forEach((s, i) => {
                const gradientId = `starGradient${i + 1}`;
                const gradient = document.querySelector(`#${gradientId} stop:nth-child(2)`);
                const firstStop = document.querySelector(`#${gradientId} stop:nth-child(1)`);
        
                // 모든 별을 회색으로
                firstStop.setAttribute('offset', '0%');
                gradient.setAttribute('offset', '0%');
              });
        
              ratingValue.textContent = '0점'; // 점수 초기화
              currentHoverIndex = -1; // 상태 초기화
              isHalfHover = false;
            }
          });
        });
        




//         document.addEventListener('DOMContentLoaded', () => {
//   const stars = document.querySelectorAll('.star');
//   const ratingValue = document.querySelector('.rating-value');
//   let selectedRating = 0; // 선택된 별점 값
//     stars.forEach((star, index) => {
  
//     // 별점 호버 이벤트
//     star.addEventListener('mousemove', (e) => {
//       const rect = star.getBoundingClientRect();
//       const offsetX = e.clientX - rect.left;
//       const isHalf = offsetX < rect.width / 2; // 반쪽 여부 확인

//       // 모든 별 초기화
//       stars.forEach((s, i) => {
//         const gradientId = `starGradient${i + 1}`;
//         console.log(gradientId);
//         const gradient = document.querySelector(`#${gradientId} stop:nth-child(2)`); // 회색 부분
//         const firstStop = document.querySelector(`#${gradientId} stop:nth-child(1)`); // 노란 부분

//         // 노란색으로 채우기
//         firstStop.setAttribute('offset', i < index || (i === index && !isHalf) ? '100%' : '50%');
//         gradient.setAttribute('offset', i < index || (i === index && !isHalf) ? '100%' : '50%');
//       });

//       // 현재 별점 표시
//       const hoverRating = isHalf ? index + 0.5 : index + 1;
//       ratingValue.textContent = `${hoverRating}점`;
//     });

//     // 별점 클릭 이벤트
//     star.addEventListener('click', (e) => {
//       const rect = star.getBoundingClientRect();
//       const offsetX = e.clientX - rect.left;
//       const isHalf = offsetX < rect.width / 2;

//       // 선택된 별점 값 저장
//       selectedRating = isHalf ? index + 0.5 : index + 1;
//       ratingValue.textContent = `${selectedRating}점`;

//       console.log('선택된 별점:', selectedRating); // 서버로 전송할 데이터
//     });
//   });

//   // 마우스를 별점 영역 밖으로 뺐을 때
//   stars.forEach((star) => {
//     star.addEventListener('mouseleave', () => {
//       stars.forEach((s, i) => {
//         const gradientId = `starGradient${i + 1}`;
//         const gradient = document.querySelector(`#${gradientId} stop:nth-child(2)`); // 회색 부분
//         const firstStop = document.querySelector(`#${gradientId} stop:nth-child(1)`); // 노란 부분

//         // 선택된 별점 유지
//         firstStop.setAttribute('offset', i < Math.floor(selectedRating) ? '100%' : i === Math.floor(selectedRating) && selectedRating % 1 === 0.5 ? '50%' : '0');
//         gradient.setAttribute('offset', i < Math.floor(selectedRating) ? '100%' : i === Math.floor(selectedRating) && selectedRating % 1 === 0.5 ? '50%' : '0');
//       });
//     });
//   });
// });

      </script>
</body>
</html>